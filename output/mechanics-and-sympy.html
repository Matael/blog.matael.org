<!DOCTYPE html>
<html lang="en">
	<head>
			<title>Thinking at Random</title>
		<meta charset="utf-8" />


		<meta name="tags" content="python" />
		<meta name="tags" content="fac" />
		<meta name="tags" content="imported" />

		<link rel=stylesheet/less type=text/css media=screen href="/theme/css/style.css" />
		<link rel=stylesheet type=text/css media=screen href="/theme/css/pygment.css" />
		<script src="/theme/js/less.min.js"></script>
	</head>

	<body>
		<div id=logo><div id=logo-wrapper>
			<header>
				<h1><a href="/"<span class=overbar><span class=big>t</span>hinking <span class=accent>at</span> <span class=big>r</span>andom</span></a></h1>
			</header>
			<nav>
				<ul>
					<li><a href="/">Writing</a></li>
					<li><a href="https://github.com/Matael">Github</a></li>
					<li><a href="https://matael.org">About</a></li>
				</ul>
			</nav>
		</div></div>
		<div id=page>
<section id=content>
	<header>
		<h1>Mechanics and Sympy</h1>
		
	</header>
	<article>

	<div id=meta>
		<p class=by-line>Published by 
				<a href="/author/matael.html" class=author>matael</a>
		</p>
		<p>On <time datetime="2015-01-04T11:28:41+01:00">Sun 04 January 2015</span></p>
		<ul class=tags>
				<li><a href="/tag/python.html">python</a></li>
				<li><a href="/tag/fac.html">fac</a></li>
				<li><a href="/tag/imported.html">imported</a></li>
		</ul>
	</div>
	<div id=article_body>
		<p>As an undergraduate student in physics, some of the code I write is related with mechanical problems.</p>
<p>This post is an attempt to find eigenpulsations and eigenvectors of a 5 degres of freedom oscillator using sympy.</p>
<div class="section" id="what-is-sympy">
<h2>What is Sympy</h2>
<p>While working with simple maths, Python's builtins and the <tt class="docutils literal">math</tt> librairy should do the trick : you'll be able to
compute almost anything you need.</p>
<p>If your work requires a more powerful tool for numerical calculations, you should take a look at <a class="reference external" href="http://www.numpy.org/">Numpy</a> or Pylab and you
would get solution to your problem.</p>
<p>But if you want to work on symbolic maths (means maths with free <em>symbols</em> that represent part of the system), you'll
have to find a formal calculation framework or symbolic math framework.</p>
<p>Software exists to do that kind of stuff :</p>
<ul class="simple">
<li><a class="reference external" href="http://www.sagemath.org/">SageMath</a></li>
<li><a class="reference external" href="http://www.wolfram.com/mathematica/">Mathematica</a> (and <a class="reference external" href="http://www.wolframalpha.com/">WolframAlpha</a>)</li>
<li>Some <a class="reference external" href="http://www.mathworks.com/">MatLab</a> plugins</li>
<li><a class="reference external" href="http://www.maplesoft.com/">Maple</a></li>
</ul>
<p><a class="reference external" href="http://sympy.org/en/index.html">Sympy</a> is a python lib (mostly python2) providing tools for symbolic algebra and resolution as well as numerical
computation. Finally, sympy does provide a way of exanching data and code with Sage, Matlab and Mathematica.</p>
<div class="section" id="installing-sympy">
<h3>Installing Sympy</h3>
<p>If you have <tt class="docutils literal">pip</tt> just run :</p>
<div class="highlight"><pre><span></span>pip install sympy
</pre></div>
<p>(On <strong>ArchLinux</strong> make sure to use <em>Python2</em> and <em>pip2</em>)</p>
<p>On my system, I run Sympy 0.7.2.</p>
</div>
</div>
<div class="section" id="problem-5dof">
<h2>Problem : 5DOF</h2>
<p>Let's take a look to our problem :</p>
<img alt="" class="align-center" src="/static/images/5ddl/oscil5.png" />
<p>We have 5 coupled oscillators (spring-mass systems) with same mass and spring constant.</p>
<p>Each mass follow a movement named <span class="formula"><i>x</i><sub><i>i</i></sub> = <i>X</i><sub><i>i</i></sub>sin(<i>ω</i><i>t</i>);∀<i>i</i> ∈ {1, 2, 3, 4, 5}</span></p>
<p>We can write equations for this kind of system quite easily :</p>
<div class="formula">
<i>m</i><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
1
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
1
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
1
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
1
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
1
</span>

</span>
</span><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
<i>x<sub>1</sub>̈</i>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x<sub>2</sub>̈</i>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x<sub>3</sub>̈</i>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x<sub>4</sub>̈</i>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x<sub>5</sub>̈</i>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">

</span>

</span>
</span> + <i>k</i><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
2
</span>
<span class="arraycell align-l">
 − 1
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − 1
</span>
<span class="arraycell align-l">
2
</span>
<span class="arraycell align-l">
 − 1
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
 − 1
</span>
<span class="arraycell align-l">
2
</span>
<span class="arraycell align-l">
 − 1
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
 − 1
</span>
<span class="arraycell align-l">
2
</span>
<span class="arraycell align-l">
 − 1
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
 − 1
</span>
<span class="arraycell align-l">
2
</span>

</span>
</span><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
<i>x</i><sub>1</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x</i><sub>2</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x</i><sub>3</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x</i><sub>4</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>x</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">

</span>

</span>
</span> = <span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">

</span>

</span>
</span>
</div>
<p>It comes :</p>
<div class="formula">
<span class="underbrace"><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
(2<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span> − <i>ω</i><sup>2</sup>)
</span>
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>
<span class="arraycell align-l">
(2<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span> − <i>ω</i><sup>2</sup>)
</span>
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>
<span class="arraycell align-l">
(2<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span> − <i>ω</i><sup>2</sup>)
</span>
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>
<span class="arraycell align-l">
(2<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span> − <i>ω</i><sup>2</sup>)
</span>
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
 − <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>
<span class="arraycell align-l">
(2<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span> − <i>ω</i><sup>2</sup>)
</span>

</span>
</span></span><sub><i>S</i></sub><span class="underbrace"><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>1</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>2</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>3</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>4</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">

</span>

</span>
</span></span><sub><i>X</i></sub> = <span class="underbrace"><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">

</span>

</span>
</span></span><sub><i>L</i></sub>
</div>
<p>We now have to translate this maths into python instances :</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">zeros</span>

<span class="c1"># Coefficient matrix</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;w0&#39;</span><span class="p">)</span> <span class="c1"># omega0</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="c1"># omega</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span>
    <span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
<span class="p">])</span>


<span class="c1"># movements amplitudes</span>
<span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">,</span><span class="n">X4</span><span class="p">,</span><span class="n">X5</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;X1 X2 X3 X4 X5&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span>
    <span class="p">[</span><span class="n">X1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">X2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">X3</span><span class="p">],</span>
    <span class="p">[</span><span class="n">X4</span><span class="p">],</span>
    <span class="p">[</span><span class="n">X5</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># initial conditions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="time-to-solve">
<h2>Time to solve</h2>
<p>For this kind of problem, one (brutal) way to solve is to try to find eigenpulsations out of the <span class="formula"><i>S</i></span> matrix (means that
we have to find all <span class="formula"><i>w</i><sup>2</sup>|<i>det</i>(<i>S</i>) = 0</span>).</p>
<div class="section" id="eigenpulsations">
<h3>Eigenpulsations</h3>
<p>Finding the determinant of a <span class="formula">5 × 5</span> matrix is not something really interesting, so let's get Python to do that :</p>
<div class="highlight"><pre><span></span><span class="n">determ</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">det_bareis</span><span class="p">()</span>
</pre></div>
<p>We could have used <tt class="docutils literal">det()</tt> instead of <tt class="docutils literal">det_bareis()</tt> but the latter is preconised for matrices with symbols.</p>
<p>Now we must solve the equation : <span class="formula">det<i>S</i> = 0</span> for <span class="formula"><i>ω</i><sup>2</sup></span>. Sympy provides something cool for that kind of thing :
<tt class="docutils literal">solve()</tt>. So let's use it and print solutions next :</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.solvers</span> <span class="kn">import</span> <span class="n">solve</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">pprint</span> <span class="c1"># for pretty printing</span>

<span class="n">eigenpulsations</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">determ</span><span class="p">,</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigenpulsations</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Solution &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; :&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;------------&quot;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
<p>We can then see that our pulsations are :</p>
<div class="formula">
<span class="array"><span class="arrayrow"><span class="bracket align-left">⎧</span></span><span class="arrayrow"><span class="bracket align-left">⎪</span></span><span class="arrayrow"><span class="bracket align-left">⎪</span></span><span class="arrayrow"><span class="bracket align-left">⎪</span></span><span class="arrayrow"><span class="bracket align-left">⎨</span></span><span class="arrayrow"><span class="bracket align-left">⎪</span></span><span class="arrayrow"><span class="bracket align-left">⎪</span></span><span class="arrayrow"><span class="bracket align-left">⎪</span></span><span class="arrayrow"><span class="bracket align-left">⎩</span></span></span><span class="array"><span class="arrayrow">
<span class="arraycell align-l">
<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">1</sub></span> = (2 − <span class="sqrt"><span class="radical">√</span><span class="ignored">(</span><span class="root">3</span><span class="ignored">)</span></span>)<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">2</sub></span> = <i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">3</sub></span> = 2<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">4</sub></span> = 3<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">5</sub></span> = (2 + <span class="sqrt"><span class="radical">√</span><span class="ignored">(</span><span class="root">3</span><span class="ignored">)</span></span>)<i>ω</i><span class="scripts"><sup class="script">2</sup><sub class="script">0</sub></span>
</span>

</span>
</span><span class="emptydot"></span>
</div>
<p>It would have take a lot longer to find that out without a computer...</p>
</div>
<div class="section" id="eigenvectors">
<h3>Eigenvectors</h3>
<p>When trying to understand how a system moves, finding its eigenvectors is really useful.</p>
<p>For us, it means solving the equation :</p>
<div class="formula">
<i>S</i><sub><i>iX</i></sub> = <i>L</i>
</div>
<p>Where <span class="formula"><i>S</i><sub><i>i</i></sub></span> is the <span class="formula"><i>S</i></span> matrix with all <span class="formula"><i>ω</i><sup>2</sup></span> replaced by <span class="formula"><i>w</i><sub><i>i</i></sub>∀<i>i</i> ∈ {1, 2, 3, 4, 5}</span>.</p>
<p>To do that, we'll use the <tt class="docutils literal">solve_linear_system()</tt> utility that takes a N*(M+1) matrix as a coefficient matrix, then
an unnested list of symbols to solve for and finally some arguments.</p>
<p>For example, to solve (from documentation) :</p>
<div class="formula">
<span class="array"><span class="arrayrow"><span class="bracket align-l">⎧</span></span><span class="arrayrow"><span class="bracket align-l">⎨</span></span><span class="arrayrow"><span class="bracket align-l">⎩</span></span></span><span class="bracketcases">
<span class="arrayrow">
<span class="case align-l">
<i>x</i> + 4<i>y</i> = 2 
</span>

</span>
<span class="arrayrow">
<span class="case align-l">
  
</span>

</span>
<span class="arrayrow">
<span class="case align-l">
 − 2<i>x</i> + <i>y</i> = 14 
</span>

</span>

</span>

</div>
<p>You would give to <tt class="docutils literal">solve_linear_system()</tt> the following matrix :</p>
<div class="formula">
<span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
1
</span>
<span class="arraycell align-l">
4
</span>
<span class="arraycell align-l">
2
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − 2
</span>
<span class="arraycell align-l">
1
</span>
<span class="arraycell align-l">
14
</span>

</span>
</span>
</div>
<p>Here, we'll have to tweak a bit our matrices before solving them : we need to replace the global <span class="formula"><i>ω</i><sup>2</sup></span> term by each
eigenpulsation :</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">solve_linear_system</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">eigenpulsations</span><span class="p">:</span>
    <span class="n">complete_sys</span> <span class="o">=</span> <span class="n">S</span><span class="p">[:,:]</span>   <span class="c1"># hard copy. Ensure to work always on a</span>
                            <span class="c1"># safe copy of our matrix</span>

    <span class="c1"># replace w**2 in matrix with current eigenpulsation</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">complete_sys</span><span class="p">)):</span>
        <span class="n">complete_sys</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">complete_sys</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># append the last column : the L matrix :)</span>
    <span class="n">complete_sys</span> <span class="o">=</span> <span class="n">complete_sys</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

    <span class="c1"># solve the system without checking for zero denominators</span>
    <span class="c1"># in kinetics, a null denominator is only a resonnance, as our system doesn&#39;t</span>
    <span class="c1"># take damping into account, we can have null denominators</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">solve_linear_system</span><span class="p">(</span><span class="n">complete_sys</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">,</span> <span class="n">X4</span><span class="p">,</span> <span class="n">X5</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c1"># print the solution we&#39;re working on</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&gt; w = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>

    <span class="c1"># then print the found values for each Xi</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;---&gt; &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
</pre></div>
<p>We will get 5 eigenvectors (one per eigenpulsation) :</p>
<div class="formula">
<i><span class="withsymbol"><span class="symbolover">⟶</span><span class="undersymbol">V<sub>1</sub></span></span></i> = <span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub><span class="sqrt"><span class="radical">√</span><span class="ignored">(</span><span class="root">3</span><span class="ignored">)</span></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
2<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub><span class="sqrt"><span class="radical">√</span><span class="ignored">(</span><span class="root">3</span><span class="ignored">)</span></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
</span>;<i><span class="withsymbol"><span class="symbolover">⟶</span><span class="undersymbol">V<sub>2</sub></span></span></i> = <span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
 − <i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − <i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
</span>;<i><span class="withsymbol"><span class="symbolover">⟶</span><span class="undersymbol">V<sub>3</sub></span></span></i> = <span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − <i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
</span>;<i><span class="withsymbol"><span class="symbolover">⟶</span><span class="undersymbol">V<sub>4</sub></span></span></i> = <span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
 − <i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − <i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
</span>;<i><span class="withsymbol"><span class="symbolover">⟶</span><span class="undersymbol">V<sub>5</sub></span></span></i> = <span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − <i>X</i><sub>5</sub><span class="sqrt"><span class="radical">√</span><span class="ignored">(</span><span class="root">3</span><span class="ignored">)</span></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
2<i>X</i><sub>5</sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 − <i>X</i><sub>5</sub><span class="sqrt"><span class="radical">√</span><span class="ignored">(</span><span class="root">3</span><span class="ignored">)</span></span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">

</span>
<span class="arrayrow">
<span class="arraycell align-l">
<i>X</i><sub>5</sub>
</span>

</span>
</span>
</div>
<p>And here we are :)
We have found each of the pulsations and associated vector so we can basically understand how this system moves.</p>
<p>If we now want to go further, we should use the modal matrix <span class="formula">Φ</span> as :</p>
<div class="formula">
Φ = {<i>V</i><sub><i>i</i></sub>;<i>i</i> ∈ {1, 2, 3, 4, 5}|<i>ω</i><sub><i>i</i></sub> &lt; <i>ω</i><sub><i>i</i> + 1</sub>}
</div>
</div>
</div>
<div class="section" id="one-more-degre">
<h2>One more degre ?</h2>
<p>This method works, but if your try to solve with that script for a system with 6DOF, you'll notice that this is pretty
slow.... It's not really optimized and we could use some tricks to infer some eigenpulsations and vectors just analyzing
the system itself (without maths :))</p>
</div>

	</article>
</section>
		</div>
		<div class=clear>&nbsp;</div>
		<footer>
			<p id=legal>Proudly powered by Pelican &mdash; 2017 &mdash; Mathieu (matael) Gaborit</p>
		</footer>
	</body>
</html>